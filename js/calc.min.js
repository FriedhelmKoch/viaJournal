/*!
 * 
 * Copyright (c) 2014 Friedhelm Koch
 *
 * This file is part of viaLinked Project. It is subject to the license terms 
 * in the LICENSE file found in the top-level directory of this distribution 
 * and at http://www.viaLinked.com/license.html. 
 * No part of viaLinked Project, including this file, may be copied, modified, 
 * propagated, or distributed except according to the terms contained in the 
 * LICENSE file.
 *
 */
var viaCalc=viaCalc||{};viaCalc.Pages=viaCalc.Pages||{};viaCalc.Pages.Kernel=function(d){var c=this,b=d.type,a=$(this).attr("calc");if(viaCalc&&viaCalc.Pages&&a&&viaCalc.Pages[a]&&viaCalc.Pages[a][b]){viaCalc.Pages[a][b].call(c)}};viaCalc.Events=function(){$("div[calc]").on("pagebeforecreate pagecreate pagebeforeload pagebeforeshow pageshow pagebeforechange pagechange pagebeforehide pagehide pageinit",viaCalc.Pages.Kernel)}();viaCalc.Pages.calculator=function(){var a=function(){viaCalc.Display.init($("#displayControl")[0]);$(".calc").tap(function(d){var c=$(this).attr("calc-key"),e=this.id;switch(e){case"key0":case"key1":case"key2":case"key3":case"key4":case"key5":case"key6":case"key7":case"key8":case"key9":case"keyDecimalPoint":viaCalc.Display.enterDigit(c);break;case"keyC":viaCalc.Display.clearDisplay();break;case"keyCe":viaCalc.Display.clearError();break;case"keySquareRoot":viaCalc.Display.squareRoot();break;case"keyPercent":viaCalc.Display.percent();break;case"keyInverseSign":viaCalc.Display.inverseSign();break;case"keyInverse":viaCalc.Display.inverse();break;case"keyAdd":viaCalc.Display.setOperator("+");break;case"keySubtract":viaCalc.Display.setOperator("-");break;case"keyMultiply":viaCalc.Display.setOperator("*");break;case"keyDivide":viaCalc.Display.setOperator("/");break;case"keyEquals":viaCalc.Display.setOperator("=");break}return false})},b=function(){$(".calc").unbind("tap")};return{pageshow:a,pagehide:b}}();viaCalc.Display=function(){var h,k,i=false,j=false,f=null,r=function(v,w){return v+w},q=function(v,w){if(w==0){alert("Can't divide by 0");return 0}return v/w},m=function(v,w){return v*w},u=function(v,w){return v-w},l=function(){if(!k||f==null){return}var w=parseFloat(h.value),v=0;switch(k){case"+":v=r(f,w);break;case"-":v=u(f,w);break;case"*":v=m(f,w);break;case"/":v=q(f,w);break}c(v);f=v},c=function(v){h.value=v},d=function(){return h.value+""},s=function(){c(-parseFloat(h.value))},e=function(){c(1/parseFloat(h.value))},g=function(){c(Math.sqrt(parseFloat(h.value)))},a=function(){var v=parseFloat(h.value);if(k==="+"||k==="-"){c(f*v/100)}else{c(v/100)}},o=function(){f=null;j=i=false;c("0")},b=function(){var v=d();if(v){v=v.slice(0,v.length-1);v=v?v:"0";c(v)}},n=function(w){var v=h.value;if(v.length<20){if(i==true||v==="0"){c("");i=false}if(w==="."&&v.indexOf(".")>=0){return}c(h.value+w)}},p=function(v){if(v==="="){j=true;l();return}if(!j){l()}j=false;k=v;i=true;f=parseFloat(h.value)},t=function(v){h=v};return{clearDisplay:o,clearError:b,inverseSign:s,inverse:e,squareRoot:g,percent:a,enterDigit:n,setOperator:p,init:t}}();
