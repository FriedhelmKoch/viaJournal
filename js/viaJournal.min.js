/*!
 * 
 * Copyright (c) 2017 Friedhelm Koch
 *
 * This file is part of viaLinked Project. It is subject to the license terms 
 * in the LICENSE file found in the top-level directory of this distribution 
 * and at http://www.viaLinked.com/license.html. 
 * No part of viaLinked Project, including this file, may be copied, modified, 
 * propagated, or distributed except according to the terms contained in the 
 * LICENSE file.
 *
 */
function showKtoPersonen(){recPersonen=viaJournalDB_085.query("Konten");var e="";for(var n=0 in recPersonen)"Personen"==recPersonen[n].ktoIdent&&(e+='<li><a href="#" class="linkKtoIndividuals" rec="'+n+'">'+recPersonen[n].ktoVorName+" "+recPersonen[n].ktoNachName+'</br><span style="font-size:.8em">'+recPersonen[n].ktoStrasse+", "+recPersonen[n].ktoPLZ+" "+recPersonen[n].ktoOrt+"</span></a></li>");$("#archivKtoPersonen").append(e).listview("refresh"),0===recPersonen&&$("#message").append("Keine Daten vorhanden!")}function editKtoIndividuals(e){$("#KtoIndividualsPage").attr("rec",e),$("body").pagecontainer("change","#KtoIndividualsPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1}),$("#ktoCompany").textinput({disabled:!0}),$("#ktoVorName").textinput({disabled:!0}),$("#ktoNachName").textinput({disabled:!0}),$("#ktoPLZ").textinput({disabled:!0}),"Herr"==$("#ktoAnrede").val(recPersonen[e].ktoAnrede)?$("#ktoAnrede").prop("checked",!0).selectmenu("refresh"):$("#ktoAnrede").removeProp("checked").selectmenu("refresh"),$("#ktoName").val(null),$("#ktoBemerkung").val(recPersonen[e].ktoBemerkung),$("#ktoCompany").val(recPersonen[e].ktoCompany),$("#ktoAnrede").val(recPersonen[e].ktoAnrede),$("#ktoVorName").val(recPersonen[e].ktoVorName),$("#ktoNachName").val(recPersonen[e].ktoNachName),$("#ktoStrasse").val(recPersonen[e].ktoStrasse),$("#ktoPLZ").val(recPersonen[e].ktoPLZ),$("#ktoOrt").val(recPersonen[e].ktoOrt),$("#ktoLand").val(recPersonen[e].ktoLand),$("#ktoTel").val(recPersonen[e].ktoTel),$("#ktoEmail").val(recPersonen[e].ktoEmail),$("#ktoBank").val(recPersonen[e].ktoBank),$("#ktoBIC").val(recPersonen[e].ktoBIC),$("#ktoIBAN").val(recPersonen[e].ktoIBAN),$(".navbarFooter_modify").show(),$(".navbarFooter_add").hide()}function deleteKtoPersonen(e){$("#delItem").text(recPersonen[e].ktoVorName+" "+recPersonen[e].ktoNachName),$("#delConfirm").popup("open"),$("#delItemBtn").bind("click",function(){viaJournalDB_085.deleteRows("Konten",function(n){return n.code==recPersonen[e].code?!0:!1}),viaJournalDB_085.commit(),$("#delConfirm").popup("close"),window.location.href="./personen.html"})}function saveKtoPersonen(e){var n=["ktoVorName","ktoNachName","ktoPLZ"];for(var a=0 in n){var o=$("#"+n[a]);if(!o.val()||""==o.val())return $(".popValidation").html("Die mit einem Stern<sup>*</sup> gekennzeichneten Felder müssen ausgefüllt werden und können nachträglich nicht geändert werden!"),void $("#validation").popup("open")}e&&recPersonen[e].code==MD5("Personen,,"+$("#ktoVorName").val()+","+$("#ktoNachName").val()+","+$("#ktoPLZ").val())?($("#doubleCheck").popup("open"),$("#doubleCheckBtn").bind("click",function(){viaJournalDB_085.insertOrUpdate("Konten",{code:MD5("Personen,,"+$("#ktoVorName").val()+","+$("#ktoNachName").val()+","+$("#ktoPLZ").val())},{code:MD5("Personen,,"+$("#ktoVorName").val()+","+$("#ktoNachName").val()+","+$("#ktoPLZ").val()),datum:$.getActualiCal("UTC"),ktoIdent:"Personen",ktoName:null,ktoBemerkung:$("#ktoBemerkung").val(),ktoCompany:null,ktoAnrede:$("#ktoAnrede").val(),ktoVorName:$("#ktoVorName").val(),ktoNachName:$("#ktoNachName").val(),ktoStrasse:$("#ktoStrasse").val(),ktoPLZ:$("#ktoPLZ").val(),ktoOrt:$("#ktoOrt").val(),ktoLand:$("#ktoLand").val(),ktoTel:$("#ktoTel").val(),ktoEmail:$("#ktoEmail").val(),ktoBank:$("#ktoBank").val(),ktoBIC:$("#ktoBIC").val(),ktoIBAN:$("#ktoIBAN").val(),ktoPicture:null}),viaJournalDB_085.commit(),$("#doubleCheck").popup("close"),window.location.href="./personen.html"})):($("#popupSuccess").popup("open"),viaJournalDB_085.insertOrUpdate("Konten",{code:MD5("Personen,,"+$("#ktoVorName").val()+","+$("#ktoNachName").val()+","+$("#ktoPLZ").val())},{code:MD5("Personen,,"+$("#ktoVorName").val()+","+$("#ktoNachName").val()+","+$("#ktoPLZ").val()),datum:$.getActualiCal("UTC"),ktoIdent:"Personen",ktoName:null,ktoBemerkung:$("#ktoBemerkung").val(),ktoCompany:null,ktoAnrede:$("#ktoAnrede").val(),ktoVorName:$("#ktoVorName").val(),ktoNachName:$("#ktoNachName").val(),ktoStrasse:$("#ktoStrasse").val(),ktoPLZ:$("#ktoPLZ").val(),ktoOrt:$("#ktoOrt").val(),ktoLand:$("#ktoLand").val(),ktoTel:$("#ktoTel").val(),ktoEmail:$("#ktoEmail").val(),ktoBank:$("#ktoBank").val(),ktoBIC:$("#ktoBIC").val(),ktoIBAN:$("#ktoIBAN").val(),ktoPicture:null}),viaJournalDB_085.commit(),setTimeout(function(){window.location.href="./personen.html"},2e3))}function addKtoPersonen(){$("body").pagecontainer("change","#KtoIndividualsPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1}),$("#ktoVorName").textinput({disabled:!1}),$("#ktoNachName").textinput({disabled:!1}),$("#ktoPLZ").textinput({disabled:!1}),$("#ktoCompany").val(null),$("#ktoAnrede").val("Herr"),$("#ktoVorName").val(null),$("#ktoNachName").val(null),$("#ktoBemerkung").val(null),$("#ktoStrasse").val(null),$("#ktoPLZ").val(null),$("#ktoOrt").val(null),$("#ktoLand").val(null),$("#ktoTel").val(null),$("#ktoEmail").val(null),$("#ktoBank").val(null),$("#ktoBIC").val(null),$("#ktoIBAN").val(null),$("ktoIndividuals").textinput("refresh"),$(".navbarFooter_modify").hide(),$(".navbarFooter_add").show()}function showKtoFonds(){recFonds=viaJournalDB_085.query("Konten");var e="";for(var n=0 in recFonds)"Fonds"==recFonds[n].ktoIdent&&(e+='<li><a href="#" class="linkKtoFondsDetail" rec="'+n+'">'+recFonds[n].ktoName+'</br><span style="font-size:.8em">'+recFonds[n].ktoBemerkung+"</span></a></li>");$("#archivKtoFonds").append(e).listview("refresh"),0===recFonds&&$("#message").append("Keine Daten vorhanden!")}function editKtoFondsDetail(e){$("#KtoFondsDetailPage").attr("rec",e),$("body").pagecontainer("change","#KtoFondsDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1}),$("#ktoName").textinput({disabled:!0}),$("#ktoName").val(recFonds[e].ktoName),$("#ktoBemerkung").val(recFonds[e].ktoBemerkung),$("#ktoVorName").val(recFonds[e].ktoVorName),$("#ktoNachName").val(recFonds[e].ktoNachName),$("#ktoBank").val(recFonds[e].ktoBank),$("#ktoBIC").val(recFonds[e].ktoBIC),$("#ktoIBAN").val(recFonds[e].ktoIBAN),$(".navbarFooter_modify").show(),$(".navbarFooter_add").hide()}function deleteKtoFonds(e){$("#delItem").text(recFonds[e].ktoName),$("#delConfirm").popup("open"),$("#delItemBtn").bind("click",function(){viaJournalDB_085.deleteRows("Konten",function(n){return n.code==recFonds[e].code?!0:!1}),viaJournalDB_085.commit(),$("#delConfirm").popup("close"),window.location.href="./fonds.html"})}function saveKtoFonds(e){var n=["ktoName"];for(var a=0 in n){var o=$("#"+n[a]);if(!o.val()||""==o.val())return $(".popValidation").html("Die mit einem Stern<sup>*</sup> gekennzeichneten Felder müssen ausgefüllt werden und können nachträglich nicht geändert werden!"),void $("#validation").popup("open")}e&&recFonds[e].code==MD5("Fonds,"+$("#ktoName").val())?($("#doubleCheck").popup("open"),$("#doubleCheckBtn").bind("click",function(){viaJournalDB_085.insertOrUpdate("Konten",{code:MD5("Fonds,"+$("#ktoName").val())},{code:MD5("Fonds,"+$("#ktoName").val()),datum:$.getActualiCal("UTC"),ktoIdent:"Fonds",ktoName:$("#ktoName").val(),ktoBemerkung:$("#ktoBemerkung").val(),ktoCompany:null,ktoAnrede:null,ktoVorName:$("#ktoVorName").val(),ktoNachName:$("#ktoNachName").val(),ktoStrasse:null,ktoPLZ:null,ktoOrt:null,ktoLand:null,ktoTel:null,ktoEmail:null,ktoBank:$("#ktoBank").val(),ktoBIC:$("#ktoBIC").val(),ktoIBAN:$("#ktoIBAN").val(),ktoPicture:null}),viaJournalDB_085.commit(),$("#doubleCheck").popup("close"),window.location.href="./fonds.html"})):($("#popupSuccess").popup("open"),viaJournalDB_085.insertOrUpdate("Konten",{code:MD5("Fonds,"+$("#ktoName").val())},{code:MD5("Fonds,"+$("#ktoName").val()),datum:$.getActualiCal("UTC"),ktoIdent:"Fonds",ktoName:$("#ktoName").val(),ktoBemerkung:$("#ktoBemerkung").val(),ktoCompany:null,ktoAnrede:null,ktoVorName:$("#ktoVorName").val(),ktoNachName:$("#ktoNachName").val(),ktoStrasse:null,ktoPLZ:null,ktoOrt:null,ktoLand:null,ktoTel:null,ktoEmail:null,ktoBank:$("#ktoBank").val(),ktoBIC:$("#ktoBIC").val(),ktoIBAN:$("#ktoIBAN").val(),ktoPicture:null}),viaJournalDB_085.commit(),setTimeout(function(){window.location.href="./fonds.html"},2e3))}function addKtoFonds(){$("body").pagecontainer("change","#KtoFondsDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1}),$("#ktoName").textinput({disabled:!1}),$("#ktoName").val(null),$("#ktoBemerkung").val(null),$("#ktoVorName").val(null),$("#ktoNachName").val(null),$("#ktoBank").val(null),$("#ktoBIC").val(null),$("#ktoIBAN").val(null),$("ktoFondsDetail").textinput("refresh"),$(".navbarFooter_modify").hide(),$(".navbarFooter_add").show()}function showKtoSachen(){recSachen=viaJournalDB_085.query("Konten");var e="";for(var n=0 in recSachen)"Sachen"==recSachen[n].ktoIdent&&(e+='<li><a href="#" class="linkKtoSachenDetail" rec="'+n+'">'+recSachen[n].ktoName+'</br><span style="font-size:.8em">'+recSachen[n].ktoBemerkung+"</span></a></li>");$("#archivKtoSachen").append(e).listview("refresh"),0===recSachen&&$("#message").append("Keine Daten vorhanden!")}function editKtoSachenDetail(e){$("#KtoSachenDetailPage").attr("rec",e),$("body").pagecontainer("change","#KtoSachenDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1}),$("#ktoName").textinput({disabled:!0}),$("#ktoName").val(recSachen[e].ktoName),$("#ktoBemerkung").val(recSachen[e].ktoBemerkung),$("#ktoVorName").val(recSachen[e].ktoVorName),$("#ktoNachName").val(recSachen[e].ktoNachName),$("#ktoBank").val(recSachen[e].ktoBank),$("#ktoBIC").val(recSachen[e].ktoBIC),$("#ktoIBAN").val(recSachen[e].ktoIBAN),$(".navbarFooter_modify").show(),$(".navbarFooter_add").hide()}function deleteKtoSachen(e){$("#delItem").text(recSachen[e].ktoName),$("#delConfirm").popup("open"),$("#delItemBtn").bind("click",function(){viaJournalDB_085.deleteRows("Konten",function(n){return n.code==recSachen[e].code?!0:!1}),viaJournalDB_085.commit(),$("#delConfirm").popup("close"),window.location.href="./sachen.html"})}function saveKtoSachen(e){var n=["ktoName"];for(var a=0 in n){var o=$("#"+n[a]);if(!o.val()||""==o.val())return $(".popValidation").html("Die mit einem Stern<sup>*</sup> gekennzeichneten Felder müssen ausgefüllt werden und können nachträglich nicht geändert werden!"),void $("#validation").popup("open")}e&&recSachen[e].code==MD5("Sachen,"+$("#ktoName").val())?($("#doubleCheck").popup("open"),$("#doubleCheckBtn").bind("click",function(){viaJournalDB_085.insertOrUpdate("Konten",{code:MD5("Sachen,"+$("#ktoName").val())},{code:MD5("Sachen,"+$("#ktoName").val()),datum:$.getActualiCal("UTC"),ktoIdent:"Sachen",ktoName:$("#ktoName").val(),ktoBemerkung:$("#ktoBemerkung").val(),ktoCompany:null,ktoAnrede:null,ktoVorName:$("#ktoVorName").val(),ktoNachName:$("#ktoNachName").val(),ktoStrasse:null,ktoPLZ:null,ktoOrt:null,ktoLand:null,ktoTel:null,ktoEmail:null,ktoBank:$("#ktoBank").val(),ktoBIC:$("#ktoBIC").val(),ktoIBAN:$("#ktoIBAN").val(),ktoPicture:null}),viaJournalDB_085.commit(),$("#doubleCheck").popup("close"),window.location.href="./sachen.html"})):($("#popupSuccess").popup("open"),viaJournalDB_085.insertOrUpdate("Konten",{code:MD5($("#ktoName").val())},{code:MD5($("#ktoName").val()),datum:$.getActualiCal("UTC"),ktoIdent:"Sachen",ktoName:$("#ktoName").val(),ktoBemerkung:$("#ktoBemerkung").val(),ktoCompany:null,ktoAnrede:null,ktoVorName:$("#ktoVorName").val(),ktoNachName:$("#ktoNachName").val(),ktoStrasse:null,ktoPLZ:null,ktoOrt:null,ktoLand:null,ktoTel:null,ktoEmail:null,ktoBank:$("#ktoBank").val(),ktoBIC:$("#ktoBIC").val(),ktoIBAN:$("#ktoIBAN").val(),ktoPicture:null}),viaJournalDB_085.commit(),setTimeout(function(){window.location.href="./sachen.html"},2e3))}function addKtoSachen(){$("body").pagecontainer("change","#KtoSachenDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1}),$("#ktoName").textinput({disabled:!1}),$("#ktoName").val(null),$("#ktoBemerkung").val(null),$("#ktoVorName").val(null),$("#ktoNachName").val(null),$("#ktoBank").val(null),$("#ktoBIC").val(null),$("#ktoIBAN").val(null),$("ktoSachenDetail").textinput("refresh"),$(".navbarFooter_modify").hide(),$(".navbarFooter_add").show()}function showKurse(){recKurse=viaJournalDB_085.query("Wechselkurse");var e="";for(var n=0 in recKurse)e+='<li><a href="#" class="linkKurseDetail" rec="'+n+'">'+recKurse[n].kursVon+recKurse[n].kursNach+" = "+recKurse[n].kursWert+'</br><span style="font-size:.8em">'+recKurse[n].kursVonBez+" zu "+recKurse[n].kursNachBez+"</span></a></li>";$("#archivKurse").append(e).listview("refresh"),0===recKurse&&$("#message").append("Keine Daten vorhanden!")}function editKurseDetail(e){$("#KurseDetailPage").attr("rec",e),$("body").pagecontainer("change","#KurseDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1}),$("#kursVon").textinput({disabled:!0}),$("#kursNach").textinput({disabled:!0}),$("#kursVon").val(recKurse[e].kursVon),$("#kursVonBez").val(recKurse[e].kursVonBez),$("#kursNach").val(recKurse[e].kursNach),$("#kursNachBez").val(recKurse[e].kursNachBez),$("#kursWert").val(recKurse[e].kursWert),$(".navbarFooter_modify").show(),$(".navbarFooter_add").hide()}function deleteKurse(e){$("#delItem").text(recKurse[e].kursVon+recKurse[e].kursNach+" = "+recKurse[e].kursWert),$("#delConfirm").popup("open"),$("#delItemBtn").bind("click",function(){viaJournalDB_085.deleteRows("Wechselkurse",function(n){return n.code==recKurse[e].code?!0:!1}),viaJournalDB_085.commit(),$("#delConfirm").popup("close"),window.location.href="./wechselkurse.html"})}function saveKurse(e){var n=["kursVonBez","kursVon","kursNachBez","kursNach","kursWert"];for(var a=0 in n){var o=$("#"+n[a]);if(!o.val()||""==o.val())return $(".popValidation").html("Es müssen alle Felder ausgefüllt werden. Die mit einem Stern<sup>*</sup> gekennzeichneten Felder können nachträglich nicht geändert werden!"),void $("#validation").popup("open")}e&&recKurse[e].code==MD5($("#kursVon").val()+","+$("#kursNach").val())?($("#doubleCheck").popup("open"),$("#doubleCheckBtn").bind("click",function(){viaJournalDB_085.insertOrUpdate("Wechselkurse",{code:MD5($("#kursVon").val()+","+$("#kursNach").val())},{code:MD5($("#kursVon").val()+","+$("#kursNach").val()),datum:$.getActualiCal("UTC"),kursVon:$("#kursVon").val(),kursVonBez:$("#kursVonBez").val(),kursNach:$("#kursNach").val(),kursNachBez:$("#kursNachBez").val(),kursWert:convertDot($("#kursWert").val())}),viaJournalDB_085.commit(),$("#doubleCheck").popup("close"),window.location.href="./wechselkurse.html"})):($("#popupSuccess").popup("open"),viaJournalDB_085.insertOrUpdate("Wechselkurse",{code:MD5($("#kursVon").val()+","+$("#kursNach").val())},{code:MD5($("#kursVon").val()+","+$("#kursNach").val()),datum:$.getActualiCal("UTC"),kursVon:$("#kursVon").val(),kursVonBez:$("#kursVonBez").val(),kursNach:$("#kursNach").val(),kursNachBez:$("#kursNachBez").val(),kursWert:convertDot($("#kursWert").val())}),viaJournalDB_085.commit(),setTimeout(function(){window.location.href="./wechselkurse.html"},2e3))}function addKurse(){$("body").pagecontainer("change","#KurseDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1}),$("#kursVon").textinput({disabled:!1}),$("#kursNach").textinput({disabled:!1}),$("#kursVon").val(null),$("#kursVonBez").val(null),$("#kursNach").val(null),$("#kursNachBez").val(null),$("#kursWert").val(null),$("KurseDetail").textinput("refresh"),$(".navbarFooter_modify").hide(),$(".navbarFooter_add").show()}function showTrans(){var e=$(location).attr("href").split("?");recTrans=viaJournalDB_085.query("Transaktionen");var n,a,o,r,t=viaJournalDB_085.query("Konten"),l="";for(var u=0 in recTrans)if(recTrans[u].transJournal==e[1]){$("#message").hide();for(var s=0 in t)t[s].code==recTrans[u].transVon?(n=t[s].ktoName?t[s].ktoName:"",a=t[s].ktoVorName?t[s].ktoVorName:"",o=t[s].ktoNachName?t[s].ktoNachName:""):t[s].code==recTrans[u].transNach&&(r=t[s].ktoName?t[s].ktoName:"",nachKtoVorName=t[s].ktoVorName?t[s].ktoVorName:"",nachKtoNachName=t[s].ktoNachName?t[s].ktoNachName:"");l+='<li><a href="#" class="linkTransDetail" rec="'+u+'" >'+recTrans[u].transName+'</br><span style="font-size:.8em">'+n+a+" "+o+" nach: "+r+nachKtoVorName+" "+nachKtoNachName+'</span></br><span style="font-size:.8em">'+recTrans[u].transDatum+", "+recTrans[u].transBetrag+" "+recTrans[u].transCurrency+"</span></a></li>"}else $("#message").html("<p><b>Bisher keine Buchungen eingetragen!</b></p><p>Wählen Sie bitte in der Fusszeile den Button: < + NEU> um eine neue Buchungen vorzunehmen.</p>");$("#archivTrans").append(l).listview("refresh"),0===recTrans&&$("#message").append("<p><b>Bisher keine Buchungen eingetragen!</b></p><p>Wählen Sie bitte in der Fusszeile den Button: < + NEU> um ein neues Journal zu beginnen.</p>")}function editTransDetail(e){var n="",a=[],o=[],r=$(location).attr("href").split("?");$("#TransDetailPage").attr("rec",e),$("body").pagecontainer("change","#TransDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1});var t=viaJournalDB_085.query("Journal");for(var l=0 in t)t[l].code==r[1]&&($("#transJournalEdit").html("Journal: "+t[l].journalName+"</br>Zeitraum: "+t[l].journalDatumVon+" - "+t[l].journalDatumBis),n=t[l].journalCurrency,a=t[l].journalPersonen,o=t[l].journalKonten);var u=viaJournalDB_085.query("Wechselkurse"),s=[],i=[],c=[];for(var l=0 in u)u[l].kursVon==n&&(s.push(u[l].kursVon),i.push(u[l].kursNach));c=union(s,i),$("#transCurrency").empty(),$.each(c,function(e,n){$("<option/>").val(n).text(n).appendTo("#transCurrency")}),$("#transCurrency").selectmenu("refresh");var d=viaJournalDB_085.query("Konten");$("#transVonPersonen, #transNachPersonen").empty(),$("#transVonFonds, #transNachFonds").empty(),$("#transNachSachen").empty();for(var l=0 in d)"Personen"==d[l].ktoIdent?$.each(a,function(e,n){n==d[l].code&&$("<option/>").val(d[l].code).text(d[l].ktoVorName+" "+d[l].ktoNachName).appendTo("#transVonPersonen, #transNachPersonen")}):"Sachen"==d[l].ktoIdent?$.each(o,function(e,n){n==d[l].code&&$("<option/>").val(d[l].code).text(d[l].ktoName).prependTo("#transNachSachen")}):"Fonds"==d[l].ktoIdent&&$.each(o,function(e,n){n==d[l].code&&$("<option/>").val(d[l].code).text(d[l].ktoName).appendTo("#transVonFonds, #transNachFonds")});$("#transVon, #transNach").selectmenu("refresh"),$("#transCode").val(recTrans[e].code),$("#transName").val(recTrans[e].transName),$("#transDatum").val(recTrans[e].transDatum),$("#transOrt").val(recTrans[e].transOrt),$("#transBetrag").val(recTrans[e].transBetrag),$("#transBIC").val(recTrans[e].transBIC),$("#transIBAN").val(recTrans[e].transIBAN),$("#transCurrency").val(recTrans[e].transCurrency).selectmenu("refresh"),$("#transVon").val(recTrans[e].transVon).selectmenu("refresh"),$("#transNach").val(recTrans[e].transNach).selectmenu("refresh"),$(".navbarFooter_modify").show(),$(".navbarFooter_add").hide()}function deleteTrans(e){$("#delItem").text(recTrans[e].transName),$("#delConfirm").popup("open"),$("#delItemBtn").bind("click",function(){viaJournalDB_085.deleteRows("Transaktionen",function(n){return n.code==recTrans[e].code?!0:!1}),viaJournalDB_085.commit(),$("#delConfirm").popup("close"),window.location.href="./transaktionen.html?"+recTrans[e].transJournal})}function saveTrans(e){var n=["transName","transDatum","transVon","transNach","transBetrag","transCurrency"];for(var a=0 in n){var o=$("#"+n[a]);if(!o.val()||""==o.val())return $(".popValidation").html("Die mit einem Stern<sup>*</sup> gekennzeichneten Felder müssen ausgefüllt werden!"),void $("#validation").popup("open")}var r=$(location).attr("href").split("?"),t=r[1].split("#"),l=$.getActualiCal("UTC"),u=$("#transCode").val()?recTrans[e].code:MD5(l+","+t[0]);e&&recTrans[e].code==u?($("#doubleCheck").popup("open"),$("#doubleCheckBtn").bind("click",function(){viaJournalDB_085.insertOrUpdate("Transaktionen",{code:u},{code:u,datum:l,transJournal:recTrans[e].transJournal,transDatum:$("#transDatum").val(),transName:$("#transName").val(),transOrt:$("#transOrt").val(),transBetrag:number_format(convertDot($("#transBetrag").val())),transCurrency:$("#transCurrency").val(),transVon:$("#transVon").val(),transNach:$("#transNach").val(),ktoGPS:null,ktoPicture:null}),viaJournalDB_085.commit(),$("#doubleCheck").popup("close"),window.location.href="./transaktionen.html?"+recTrans[e].transJournal})):(viaJournalDB_085.insertOrUpdate("Transaktionen",{code:u},{code:u,datum:l,transJournal:t[0],transDatum:$("#transDatum").val(),transName:$("#transName").val(),transOrt:$("#transOrt").val(),transBetrag:number_format(convertDot($("#transBetrag").val())),transCurrency:$("#transCurrency").val(),transVon:$("#transVon").val(),transNach:$("#transNach").val(),ktoGPS:null,ktoPicture:null}),viaJournalDB_085.commit(),setTimeout(function(){$("#popupSuccess").popup("open")},2e3),$("#popupSuccess").popup("close"),window.location.href="./transaktionen.html?"+t[0])}function addTrans(){var e="",n=[],a=[],o=$(location).attr("href").split("?");$("body").pagecontainer("change","#TransDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1});var r=viaJournalDB_085.query("Journal");for(var t=0 in r)r[t].code==o[1]&&($("#transJournalEdit").html("Journal: "+r[t].journalName+"</br>Zeitraum: "+r[t].journalDatumVon+" - "+r[t].journalDatumBis),e=r[t].journalCurrency,n=r[t].journalPersonen,a=r[t].journalKonten);var l=viaJournalDB_085.query("Wechselkurse"),u=[],s=[],i=[];for(var t=0 in l)l[t].kursVon==e&&(u.push(l[t].kursVon),s.push(l[t].kursNach));i=union(u,s),$("#transCurrency").empty(),$.each(i,function(e,n){$("<option/>").val(n).text(n).appendTo("#transCurrency")}),$("#transCurrency").selectmenu("refresh");var c=viaJournalDB_085.query("Konten");$("#transVonPersonen, #transNachPersonen").empty(),$("#transVonFonds, #transNachFonds").empty(),$("#transNachSachen").empty();for(var t=0 in c)"Personen"==c[t].ktoIdent?$.each(n,function(e,n){n==c[t].code&&$("<option/>").val(c[t].code).text(c[t].ktoVorName+" "+c[t].ktoNachName).appendTo("#transVonPersonen, #transNachPersonen")}):"Sachen"==c[t].ktoIdent?$.each(a,function(e,n){n==c[t].code&&$("<option/>").val(c[t].code).text(c[t].ktoName).prependTo("#transNachSachen")}):"Fonds"==c[t].ktoIdent&&$.each(a,function(e,n){n==c[t].code&&$("<option/>").val(c[t].code).text(c[t].ktoName).appendTo("#transVonFonds, #transNachFonds")});$("#transVon, #transNach").selectmenu("refresh"),$("#transCode").val(null),$("#transName").val(null),$("#transDatum").val(null),$("#transOrt").val(null),$("#transBetrag").val(null),$("#transGPS").val(null),$("#transPicture").val(null),$("#transVon").val(null),$("#transNach").val(null),$(".navbarFooter_modify").hide(),$(".navbarFooter_add").show()}function showJournal(){recJournal=viaJournalDB_085.query("Journal");var e="";for(var n=0 in recJournal)e+='<li><a href="#" class="linkJournalDetail" rec="'+n+'">'+recJournal[n].journalName+'</br><span style="font-size:.8em">'+recJournal[n].journalBemerkung+'</span></br><span style="font-size:.8em">'+recJournal[n].journalDatumVon+" bis: "+recJournal[n].journalDatumBis+"</span></a></li>";$("#archivJournal").append(e).listview("refresh"),0===recJournal&&$("#message").append("<p><b>Keine Journale eingetragen!</b></p><p>Wählen Sie bitte in der Fusszeile den Button: < + NEU> um ein neues Journal zu beginnen.</p>");var a=$(location).attr("href").split("?");a[1]&&editJournalDetail(a[1])}function editJournalDetail(e){$("body").pagecontainer("change","#JournalDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reload:!1}),$("#JournalDetailPage").attr("rec",e);var n=viaJournalDB_085.query("Konten");$("#journalLeader").empty();for(var a=0 in n)"Personen"==n[a].ktoIdent&&$("<option/>").val(n[a].code).text(n[a].ktoVorName+" "+n[a].ktoNachName).appendTo("#journalLeader");$("#journalLeader").selectmenu("refresh");var o=viaJournalDB_085.query("Wechselkurse"),r=[],t=[],l=[];for(var a=0 in o)r.push(o[a].kursVon);l=union(r,t),$("#journalCurrency").empty(),$.each(l,function(e,n){$("<option/>").val(n).text(n).appendTo("#journalCurrency")}),$("#journalCurrency").selectmenu("refresh",!0),$("#journalPersonen, #journalKonten, #journalLeader").empty(),$("<option/>").text("Wähle Teilnehmer...").appendTo("#journalPersonen"),$("<option/>").text("Wähle Konten...").appendTo("#journalKonten");for(var a=0 in n){if("Personen"==n[a].ktoIdent){var u=!0;$.each(recJournal[e].journalPersonen,function(e,o){n[a].code==o&&($("#journalPersonen").append('<option selected="selected" value="'+n[a].code+'">'+n[a].ktoVorName+" "+n[a].ktoNachName+"</option>"),u=!1)}),u&&$("#journalPersonen").append('<option value="'+n[a].code+'">'+n[a].ktoVorName+" "+n[a].ktoNachName+"</option>"),$("<option/>").val(n[a].code).text(n[a].ktoVorName+" "+n[a].ktoNachName).appendTo("#journalLeader")}if("Sachen"==n[a].ktoIdent||"Fonds"==n[a].ktoIdent){var u=!0;$.each(recJournal[e].journalKonten,function(e,o){n[a].code==o&&($("#journalKonten").append('<option selected="selected" value="'+n[a].code+'">'+n[a].ktoName+"</option>"),u=!1)}),u&&$("#journalKonten").append('<option value="'+n[a].code+'">'+n[a].ktoName+"</option>")}}$("#journalPersonen, #journalKonten, #journalLeader").selectmenu("refresh",!0),$("#journalName").textinput({disabled:!0}),$("#journalDatumVon").textinput({disabled:!0}),$("#journalDatumBis").textinput({disabled:!0}),$("#journalName").val(recJournal[e].journalName),$("#journalBemerkung").val(recJournal[e].journalBemerkung),$("#journalLeader").val(recJournal[e].journalLeader),$("#journalDatumVon").val(recJournal[e].journalDatumVon),$("#journalDatumBis").val(recJournal[e].journalDatumBis),$("#journalCurrency").val(recJournal[e].journalCurrency).selectmenu("refresh",!0),$("#journalLeader").val(recJournal[e].journalLeader).selectmenu("refresh",!0),$(".navbarFooter_modify").show(),$(".navbarFooter_add").hide()}function deleteJournal(e){$("#delItem").text(recJournal[e].journalName),$("#delConfirm").popup("open"),$("#delItemBtn").bind("click",function(){viaJournalDB_085.deleteRows("Journal",function(n){return n.code==recJournal[e].code?!0:!1}),viaJournalDB_085.commit(),viaJournalDB_085.deleteRows("Transaktionen",function(n){return n.transJournal==recJournal[e].code?!0:!1}),viaJournalDB_085.commit(),$("#delConfirm").popup("close"),window.location.href="./index.html"})}function saveJournal(e){var n=["journalName","journalPersonen","journalKonten","journalDatumVon","journalDatumBis"];for(var a=0 in n){var o=$("#"+n[a]);if(!o.val()||""==o.val())return $(".popValidation").html("Es müssen alle Felder ausgefüllt werden. Die mit einem Stern<sup>*</sup> gekennzeichneten Felder können nachträglich nicht geändert werden!"),void $("#validation").popup("open")}var r=MD5($("journalName").val()+","+$("#journalDatumVon").val()+","+$("#journalDatumBis").val())||void 0;e&&recJournal[e].code==r?($("#doubleCheck").popup("open"),$("#doubleCheckBtn").bind("click",function(){viaJournalDB_085.insertOrUpdate("Journal",{code:r},{code:r,datum:$.getActualiCal("UTC"),journalName:$("#journalName").val(),journalBemerkung:$("#journalBemerkung").val(),journalDatumVon:$("#journalDatumVon").val(),journalDatumBis:$("#journalDatumBis").val(),journalLeader:$("#journalLeader").val(),journalPersonen:$("#journalPersonen").val(),journalTransaktionen:[],journalKonten:$("#journalKonten").val(),journalKurse:[],journalCurrency:$("#journalCurrency").val(),journalPicture:null}),viaJournalDB_085.commit(),$("#doubleCheck").popup("close"),window.location.href="./index.html"})):($("#popupSuccess").popup("open"),viaJournalDB_085.insertOrUpdate("Journal",{code:r},{code:r,datum:$.getActualiCal("UTC"),journalName:$("#journalName").val(),journalBemerkung:$("#journalBemerkung").val(),journalDatumVon:$("#journalDatumVon").val(),journalDatumBis:$("#journalDatumBis").val(),journalLeader:$("#journalLeader").val(),journalPersonen:$("#journalPersonen").val(),journalTransaktionen:[],journalKonten:$("#journalKonten").val(),journalKurse:[],journalCurrency:$("#journalCurrency").val(),journalPicture:null}),viaJournalDB_085.commit(),setTimeout(function(){window.location.href="./index.html"},2e3))}function addJournal(){$("body").pagecontainer("change","#JournalDetailPage",{allowSamePageTransition:!0,transition:"fade",showLoadMsg:!1,reloadPage:!1});var e=viaJournalDB_085.query("Wechselkurse"),n=[],a=[],o=[];for(var r=0 in e)n.push(e[r].kursVon);o=union(n,a),$("#journalCurrency").empty(),$.each(o,function(e,n){$("<option/>").val(n).text(n).appendTo("#journalCurrency")}),$("#journalCurrency").selectmenu("refresh",!0);var t=viaJournalDB_085.query("Konten");$("#journalLeader, #journalPersonen, #journalKonten").empty(),$("<option/>").val(null).text("Wähle Teilnehmer...").appendTo("#journalPersonen"),$("<option/>").val(null).text("Wähle Konten...").appendTo("#journalKonten");for(var r=0 in t)"Personen"==t[r].ktoIdent&&$("<option/>").val(t[r].code).text(t[r].ktoVorName+" "+t[r].ktoNachName).appendTo("#journalLeader, #journalPersonen"),("Sachen"==t[r].ktoIdent||"Fonds"==t[r].ktoIdent)&&$("<option/>").val(t[r].code).text(t[r].ktoName).appendTo("#journalKonten");$("#journalLeader, #journalPersonen, #journalKonten").selectmenu("refresh",!0),$("#journalLeader option:first").prop("selected","selected").selectmenu("refresh",!0),$("#journalName").textinput({disabled:!1}),$("#journalDatumVon").textinput({disabled:!1}),$("#journalDatumBis").textinput({disabled:!1}),$("#journalName").val(null),$("#journalBemerkung").val(null),$("#journalDatumVon").val(null),$("#journalDatumBis").val(null),$("#journalLeader").val(null),$("#journalPersonen").val(null),$("#journalKonten").val(null),$("#journalTransaktionen").val(null),$("#journalKonten").val("[]"),$("#journalKurse").val("[]"),$("#journalPicture").val(null),$("#JournalDetail").textinput("refresh"),$(".navbarFooter_modify").hide(),$(".navbarFooter_add").show()}function showReports(){var e=[],n=[],a=0,o=0,r=0,t=0,l=0,u=0,s=0,i=0,c="",d="",m="",v="",p="",k="",h="",f="",N="",g="",B=[],b="  - ",y="  -------------- ";urlPara=$(location).attr("href").split("?");var P=viaJournalDB_085.query("Journal");for(var D=0 in P)if(P[D].code==urlPara[1]){N=P[D].journalLeader,journalName=P[D].journalName,refCurrency=P[D].journalCurrency,o=P[D].journalPersonen.length;var _=P[D].journalName+'</br><span style="font-size:.8em">'+P[D].journalBemerkung+"</br> Zeitraum: "+P[D].journalDatumVon+" - "+P[D].journalDatumBis+"</span>",C=P[D].journalBemerkung+"\nZeitraum: "+P[D].journalDatumVon+" - "+P[D].journalDatumBis+"\n----------------------\n";$("#reportHeader").html(_),$("#mailReport").append(C)}var K=viaJournalDB_085.query("Wechselkurse"),j=[];for(var V=0 in K)j[V]=[K[V].kursVon,K[V].kursNach,K[V].kursWert];var I=viaJournalDB_085.query("Konten"),w=viaJournalDB_085.queryAll("Transaktionen",{sort:[["transVon","ASC"]]});for(var D=0 in w)if(w[D].transJournal==urlPara[1]){for(var V=0 in I)w[D].transVon==I[V].code?(v=I[V].ktoVorName?I[V].ktoVorName+" "+I[V].ktoNachName:I[V].ktoName,p=I[V].ktoIdent,I[V].ktoEmail&&transVonEmail.push(I[V].ktoEmail)):w[D].transNach==I[V].code&&(k=I[V].ktoVorName?I[V].ktoVorName+" "+I[V].ktoNachName:I[V].ktoName,h=I[V].ktoIdent);if(w[D].transCurrency==refCurrency)r=w[D].transBetrag;else for(var V=0 in j)j[V][0]==w[D].transCurrency?r=w[D].transBetrag*j[V][2]:j[V][1]==w[D].transCurrency&&(r=w[D].transBetrag/j[V][2]);e[D]=[],e[D]={datum:w[D].transDatum,ort:w[D].transOrt,name:w[D].transName,von:w[D].transVon,vonName:v,vonIdent:p,nach:w[D].transNach,nachName:k,nachIdent:h,betrag:w[D].transBetrag,currency:w[D].transCurrency,exBetrag:parseFloat(r),exCurrency:refCurrency}}transVonEmail=uniqueArr(transVonEmail),e.sort(function(e,n){var e=e.vonName,n=n.vonName;return e==n?0:e>n?1:-1});for(var D=0 in e)if(V=0==D?0:D-1,0==D||e[D].vonName!=e[V].vonName?(m=e[D].vonName+':</br><div style="font-size:.9em; text-indent:1em;">'+e[D].name+": "+number_format(e[D].betrag,2,",",".")+' <span style="font-size:.8em">'+e[D].currency+"</span></div>",outKonten_mail=e[D].vonName+":\n"+b+e[D].name+": "+number_format(e[D].betrag,2,",",".")+" "+e[D].currency+"\n",("Fonds"==e[D].vonIdent||"Personen"==e[D].vonIdent)&&($("#reportKontenSoll").append(m),
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				 $("#mailReport_KontenAusgaben").append(outKonten_mail)),t+=parseFloat(e[D].exBetrag)):(m='<div style="font-size:.9em; text-indent:1em;">'+e[D].name+": "+number_format(e[D].betrag,2,",",".")+' <span style="font-size:.8em">'+e[D].currency+"</span></div>",outKonten_mail=b+e[D].name+": "+number_format(e[D].betrag,2,",",".")+" "+e[D].currency+"\n",("Fonds"==e[D].vonIdent||"Personen"==e[D].vonIdent)&&($("#reportKontenSoll").append(m),$("#mailReport_KontenAusgaben").append(outKonten_mail)),t+=parseFloat(e[D].exBetrag)),V=D==e.length?e.length:parseInt(D)+1,e[V]){if(e[D].vonName!=e[V].vonName){d='<div style="font-size:.9em; text-indent:10em;">Subtotal: <b>'+number_format(t,2,",",".")+" "+refCurrency+"</b>",outBetrag_mail=y+"Subtotal: "+number_format(t,2,",",".")+" "+refCurrency+"\n",("Fonds"==e[D].vonIdent||"Personen"==e[D].vonIdent)&&($("#reportKontenSoll").append(d),$("#mailReport_KontenAusgaben").append(outBetrag_mail));var J=n.length;n[J]=[],n[J]={ident:e[D].vonIdent,von:e[D].von,vonName:e[D].vonName,nach:null,nachName:null,vonBetrag:t,nachBetrag:null},t=0}}else{d='<div style="font-size:.9em; text-indent:10em;">Subtotal: <b>'+number_format(t,2,",",".")+" "+refCurrency+"</b>",outBetrag_mail=y+"Subtotal: "+number_format(t,2,",",".")+" "+refCurrency+"\n",("Fonds"==e[D].vonIdent||"Personen"==e[D].vonIdent)&&($("#reportKontenSoll").append(d),$("#mailReport_KontenAusgaben").append(outBetrag_mail));var J=n.length;n[J]=[],n[J]={ident:e[D].vonIdent,von:e[D].von,vonName:e[D].vonName,nach:null,nachName:null,vonBetrag:t,nachBetrag:null},t=0}e.sort(function(e,n){var e=e.nachName,n=n.nachName;return e==n?0:e>n?1:-1});for(var D=0 in e)if(V=0==D?0:D-1,0==D||e[D].nachName!=e[V].nachName?(m=e[D].nachName+':</br><div style="font-size:.9em; text-indent:1em;">'+e[D].name+": "+number_format(e[D].betrag,2,",",".")+' <span style="font-size:.8em">'+e[D].currency+"</span></div>",outKonten_mail=e[D].nachName+":\n"+b+e[D].name+": "+number_format(e[D].betrag,2,",",".")+e[D].currency+"\n","Fonds"==e[D].nachIdent||"Personen"==e[D].nachIdent?($("#reportKontenHaben").append(m),$("#mailReport_KontenEinnahmen").append(outKonten_mail)):"Sachen"==e[D].nachIdent&&($("#reportKontenSachen").append(m),$("#mailReport_KontenSachen").append(outKonten_mail)),l+=parseFloat(e[D].exBetrag)):(m='<div style="font-size:.9em; text-indent:1em;">'+e[D].name+": "+number_format(e[D].betrag,2,",",".")+' <span style="font-size:.8em">'+e[D].currency+"</span></div>",outKonten_mail=b+e[D].name+": "+number_format(e[D].betrag,2,",",".")+" "+e[D].currency+"\n","Fonds"==e[D].nachIdent||"Personen"==e[D].nachIdent?($("#reportKontenHaben").append(m),$("#mailReport_KontenEinnahmen").append(outKonten_mail)):"Sachen"==e[D].nachIdent&&($("#reportKontenSachen").append(m),$("#mailReport_KontenSachen").append(outKonten_mail)),l+=parseFloat(e[D].exBetrag)),V=D==e.length?e.length:parseInt(D)+1,e[V]){if(e[D].nachName!=e[V].nachName){"Fonds"==e[D].nachIdent||"Personen"==e[D].nachIdent?(d='<div style="font-size:.9em; text-indent:10em;">Subtotal: <b>'+number_format(l,2,",",".")+" "+refCurrency+"</b>",outBetrag_mail=y+"Subtotal: "+number_format(l,2,",",".")+" "+refCurrency+"\n",$("#reportKontenHaben").append(d),$("#mailReport_KontenEinnahmen").append(outBetrag_mail)):"Sachen"==e[D].nachIdent&&(d='<div style="font-size:.9em; text-indent:10em;">Subtotal: <b>'+number_format(l,2,",",".")+" "+refCurrency+"</b>",outBetrag_mail=y+"Subtotal: "+number_format(l,2,",",".")+" "+refCurrency+"\n",$("#reportKontenSachen").append(d),$("#mailReport_KontenSachen").append(outBetrag_mail));var J=n.length;n[J]=[],n[J]={ident:e[D].nachIdent,von:null,vonName:null,nach:e[D].nach,nachName:e[D].nachName,vonBetrag:null,nachBetrag:l},l=0}}else{"Fonds"==e[D].nachIdent||"Personen"==e[D].nachIdent?(d='<div style="font-size:.9em; text-indent:10em;">Subtotal: <b>'+number_format(l,2,",",".")+" "+refCurrency+"</b>",outBetrag_mail=y+"Subtotal: "+number_format(l,2,",",".")+" "+refCurrency+"\n",$("#reportKontenHaben").append(d),$("#mailReport_KontenEinnahmen").append(outBetrag_mail)):("Sachen"==e[D].nachIdent||"Personen"==e[D].nachIdent)&&(d='<div style="font-size:.9em; text-indent:10em;">Subtotal: <b>'+number_format(l,2,",",".")+" "+refCurrency+"</b>",outBetrag_mail=y+"Subtotal: "+number_format(l,2,",",".")+" "+refCurrency+"\n",$("#reportKontenSachen").append(d),$("#mailReport_KontenSachen").append(outBetrag_mail));var J=n.length;n[J]=[],n[J]={ident:e[D].nachIdent,von:null,vonName:null,nach:e[D].nach,nachName:e[D].nachName,vonBetrag:null,nachBetrag:l},l=0}e.sort(function(e,n){var e=e.datum,n=n.datum;return e==n?0:e>n?1:-1});for(var D=0 in e){var S=e[D].ort?" ("+e[D].ort+")":"",T=e[D].datum+'<span style="font-size:.9em">'+S+": </br>"+e[D].name+"</br>"+e[D].vonName+" an "+e[D].nachName+" : "+number_format(e[D].betrag,0,",",".")+' <span style="font-size:.8em">'+e[D].currency+'</span></span><hr size="1px" align="left" width="50%" color="#c0c0c0" noshade>',F=e[D].datum+" "+S+":\n"+e[D].name+"\n"+e[D].vonName+" an "+e[D].nachName+" : "+number_format(e[D].betrag,0,",",".")+" "+e[D].currency+"\n----------------------\n";$("#reportJournal").append(T),$("#mailReport_reportJournal").append(F)}for(var D=0 in e)"Fonds"==e[D].vonIdent&&"Sachen"==e[D].nachIdent?a+=e[D].exBetrag:"Personen"==e[D].vonIdent&&"Sachen"==e[D].nachIdent&&(a+=e[D].exBetrag);n.sort(function(e,n){var e=e.ident,n=n.ident;return e==n?0:e>n?1:-1});for(var D=0 in n)for(var V=D in n)n[D].von==n[V].nach&&(n[D]={ident:n[D].ident,von:n[D].von,vonName:n[D].vonName,nach:n[V].nach,nachName:n[V].nachName,vonBetrag:n[D].vonBetrag,nachBetrag:n[V].nachBetrag});for(var D=0 in n)"Fonds"==n[D].ident&&(u+=n[D].vonBetrag-n[D].nachBetrag),n[D].von==N&&(journalLeaderName=n[D].vonName);var z='<span style="font-size:.8em">Ausgaben insgesamt: <b>'+number_format(a,0,",",".")+' <span style="font-size:.8em">'+refCurrency+'</b></span></br><span style="font-size:0.8em">Anzahl PAX: <b>'+o+'</b></span></br><span style="font-size:0.8em">Ausgaben pro PAX: <b>'+number_format(a/o,2,",",".")+' <span style="font-size:.8em">'+refCurrency+'</b></span></br><span style="font-size:0.8em">Journal verwaltet von: <b>'+journalLeaderName+"</b></span></br></span>";$("#reportHeaderAbrechnung").append(z);for(var D=0 in n)if("Fonds"==n[D].ident&&"Personen"==n[parseInt(D)+1].ident&&$("#reportHeaderKonten").append('<hr size="1px" align="left" width="50%" color="#c0c0c0" noshade>'),"Personen"==n[D].ident?(s=n[D].vonBetrag-n[D].nachBetrag-a/o,i=n[D].vonBetrag-n[D].nachBetrag-a/o+u,n[D].vonName&&n[D].von!=N?offZahlungPers.push(s+";"+n[D].vonName):n[D].von==N&&offZahlungPers.push(i+";"+n[D].vonName),c=n[D].von==N?'<div style="text-indent:2.5em;"><span style="font-size:1.0em">Offene Zahlung: <b>'+number_format(s,2,",",".")+'</span> <span style="font-size:.8em">'+refCurrency+'</b></span></div><div style="text-indent:2.5em;"> <span style="font-size:1.0em">Abzüglich Kasseninhalt: <b>'+number_format(i,2,",",".")+'</span> <span style="font-size:.8em">'+refCurrency+'</b></span></div><div style="text-indent:3.3em;font-size:.8em;">'+f+"</div>":'<div style="text-indent:2.5em;"><span style="font-size:1.0em">Offene Zahlung: <b>'+number_format(s,2,",",".")+'</span> <span style="font-size:.8em">'+refCurrency+'</b></span> </div><div style="text-indent:3.3em;font-size:.8em;">'+f+"</div>"):c="",null!==n[D].von||null!==n[D].nach){var _='<span style="font-size:.8em">'+n[D].vonName+':</br><div style="text-indent:1.5em;">Aus.: '+number_format(n[D].vonBetrag,2,",",".")+' <span style="font-size:.8em">'+refCurrency+'</span><span style="font-size:1.0em">, Ein.: '+number_format(n[D].nachBetrag,2,",",".")+' <span style="font-size:.8em">'+refCurrency+'</span> </div><div style="text-indent:2.5em;"><span style="font-size:1.0em">Überschuss: '+number_format(n[D].vonBetrag-n[D].nachBetrag,2,",",".")+'</span> <span style="font-size:.8em">'+refCurrency+"</span> </div>"+c;$("#reportHeaderKonten").append(_)}$("#reportHeaderKonten").append('<span style="font-size:.7em">(+ zuviel, - zu wenig gezahlt)</span>');var V=0;for(var D=0 in offZahlungPers){var x=offZahlungPers[D].split(";");0!=parseFloat(round(x[0],2))&&(B[V]=[],B[V]={betrag:parseFloat(x[0]),name:x[1]},V++)}B.sort(function(e,n){var e=e.betrag,n=n.betrag;return e==n?0:e>n?-1:1});var A=B.length-1,V=0;do if(parseFloat(B[A].betrag)<=0){var L=parseFloat(B[A].betrag)+parseFloat(B[V].betrag);if(0>L){g+='<div style="text-indent:1.5em;">'+B[A].name+" zahlt: "+number_format(B[V].betrag,2,",",".")+" "+refCurrency+" an: "+B[V].name+"</div>";var O=B[A].betrag;B[A].betrag=L,B[V].betrag=O+parseFloat(B[V].betrag)-L,V++}else{g+='<div style="text-indent:1.5em;">'+B[A].name+" zahlt: "+number_format(-1*B[A].betrag,2,",",".")+" "+refCurrency+" an: "+B[V].name+"</div>";var O=B[A].betrag;B[A].betrag=parseFloat(B[A].betrag)-parseFloat(B[A].betrag),B[V].betrag=parseFloat(B[V].betrag)+O,A--}}else V++,g="Die Einzahlungen (Offene Zahlungen) werden 1:1 an die Teilnehmer die eingezahlt haben zurückgezahlt!";while(A>V);var M='<span style="font-size:.8em"><neue Zeile><b>Zahlungsplan:</b><br>'+g+"</span>";$("#reportZahlungsplan").append(M)}$(document).ready(function(){return $(".Support_Email").click(function(){var e="Sehr geehrtes viaJournal Team,\n\nwir hätten gerne folgende Funktion zusätzlich intergiert...\n\nWir möchten gerne folgenden Bug mitteilen...\n\nDanke und beste Grüsse,\n...";window.location.href="mailto:support@vialinked.com?subject=Verbesserungsvorschlag / Bug-Report&body="+encodeURI(e)}),!1}),function(e,n,a,o,r,t,l){e.GoogleAnalyticsObject=r,e[r]=e[r]||function(){(e[r].q=e[r].q||[]).push(arguments)},e[r].l=1*new Date,t=n.createElement(a),l=n.getElementsByTagName(a)[0],t.async=1,t.src=o,l.parentNode.insertBefore(t,l)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-99303104-1","auto"),ga("send","pageview");
